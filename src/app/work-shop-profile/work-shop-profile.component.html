<div class="container mt-5 text-white">
  <!-- Workshop Details Display -->
  <div *ngIf="!editMode" class="card bg-custom p-4 shadow text-white">
    <div class="row align-items-center">
      <div class="col-md-4 text-center">
        <img
          [src]="workshop.personalPhoto || 'https://via.placeholder.com/150'"
          alt="Profile Photo"
          class="rounded-circle shadow avatar-img"
        />
      </div>
      <div class="col-md-8">
        <h2 class="display-6 text-highlight mb-4">{{ workshop.fullName }}</h2>
        <p><strong>Email:</strong> {{ workshop.email }}</p>
        <p><strong>Phone:</strong> {{ workshop.phone }}</p>
        <p><strong>Address:</strong> {{ workshop.address }}</p>
        <p><strong>Role:</strong> {{ workshop.role }}</p>
        <p><strong>Balance:</strong> {{ workshop.balance | currency }}</p>
        <p><strong>Register Status:</strong> {{ workshop.registerStatus }}</p>
        <p><strong>Orders Sold:</strong> {{ workshop.ordersSold }}</p>
        <p><strong>Updated At:</strong> {{ workshop.updatedAt | date:'medium' }}</p>
        <p *ngIf="workshop.description"><strong>Description:</strong> {{ workshop.description }}</p>
      </div>
    </div>
    <section *ngIf="workshop.registrationDocuments" class="document-section mt-4">
      <h2 class="section-title">Registration Documents</h2>
      <div class="row">
        <div class="col-md-3" *ngFor="let doc of documentTypes">
          <div class="card document-card mb-4">
            <img [src]="workshop.registrationDocuments[doc.key]" class="card-img-top" alt="{{ doc.name }}" />
            <div class="card-body">
              <h5 class="card-title">{{ doc.name }}</h5>
              <a [href]="workshop.registrationDocuments[doc.key]" target="_blank" class="btn btn-primary">View</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <button class="btn btn-outline-light btn-lg px-4 mt-3" (click)="toggleEditMode()">Edit</button>
  </div>

  <!-- Workshop Edit Form -->
  <div class="container mt-5 text-white">
    <!-- Workshop Edit Form -->
    <div *ngIf="editMode" class="card bg-custom p-4 shadow-lg">
      <form (ngSubmit)="saveWorkshop()" #workshopForm="ngForm">
        <div class="row">
          <div class="col-md-4 text-center mb-3">
            <img
              [src]="workshop.personalPhoto || 'https://via.placeholder.com/150'"
              alt="Profile Photo"
              class="rounded-circle shadow avatar-img"
            />
            <input
              type="file"
              class="form-control mt-3 bg-input"
              (change)="onFileSelected($event)"
              accept="image/*"
            />
          </div>
          <div class="col-md-8">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="fullName" class="form-label text-highlight">Full Name</label>
                <input
                  id="fullName"
                  type="text"
                  name="fullName"
                  [(ngModel)]="workshop.fullName"
                  required
                  minlength="2"
                  maxlength="100"
                  class="form-control form-control-lg bg-input"
                  [class.is-invalid]="workshopForm.submitted && !workshop.fullName"
                />
                <div *ngIf="workshopForm.submitted && !workshop.fullName" class="invalid-feedback">
                  Full name is required.
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="email" class="form-label text-highlight">Email</label>
                <input
                  id="email"
                  type="email"
                  name="email"
                  [(ngModel)]="workshop.email"
                  required
                  class="form-control form-control-lg bg-input"
                  [class.is-invalid]="workshopForm.submitted && !workshop.email"
                />
                <div *ngIf="workshopForm.submitted && !workshop.email" class="invalid-feedback">
                  A valid email is required.
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="phone" class="form-label text-highlight">Phone</label>
                <input
                  id="phone"
                  type="text"
                  name="phone"
                  [(ngModel)]="workshop.phone"
                  required
                  pattern="^(010|011|012|015)[0-9]{8}$"
                  class="form-control form-control-lg bg-input"
                  [class.is-invalid]="workshopForm.submitted && !workshop.phone"
                />
                <div *ngIf="workshopForm.submitted && !workshop.phone" class="invalid-feedback">
                  Valid Egyptian phone number is required. Example: 010xxxxxxxx.
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="address" class="form-label text-highlight">Address</label>
                <input
                  id="address"
                  type="text"
                  name="address"
                  [(ngModel)]="workshop.address"
                  required
                  minlength="5"
                  class="form-control form-control-lg bg-input"
                  [class.is-invalid]="workshopForm.submitted && !workshop.address"
                />
                <div *ngIf="workshopForm.submitted && !workshop.address" class="invalid-feedback">
                  Address is required.
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="password" class="form-label text-highlight">New Password</label>
                <input
                  id="password"
                  type="password"
                  name="password"
                  [(ngModel)]="workshop.password"
                  #password="ngModel"
                  minlength="8"
                  class="form-control form-control-lg bg-input"
                  [class.is-invalid]="password.invalid && (password.dirty || password.touched)"
                />
                <div *ngIf="password.invalid && (password.dirty || password.touched)" class="invalid-feedback">
                  <div *ngIf="password.errors?.['minlength']">Password must be at least 8 characters long.</div>
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="confirmPassword" class="form-label text-highlight">Confirm Password</label>
                <input
                  id="confirmPassword"
                  type="password"
                  name="confirmPassword"
                  [(ngModel)]="workshop.confirmPassword"
                  #confirmPassword="ngModel"
                  [class.is-invalid]="confirmPassword.invalid && (confirmPassword.dirty || confirmPassword.touched) || workshop.password !== workshop.confirmPassword"
                  class="form-control form-control-lg bg-input"
                />
                <div *ngIf="workshop.password !== workshop.confirmPassword" class="invalid-feedback">
                  Passwords do not match.
                </div>
              </div>
            </div>

            <!-- Add description field -->
            <div class="mb-3">
              <label for="description" class="form-label text-highlight">Description</label>
              <textarea
                id="description"
                name="description"
                [(ngModel)]="workshop.description"
                rows="4"
                class="form-control bg-input"
                maxlength="500"
                [class.is-invalid]="workshopForm.submitted && workshop.description.length > 500"
              ></textarea>
              <div *ngIf="workshopForm.submitted && workshop.description.length > 500" class="invalid-feedback">
                Description cannot exceed 500 characters.
              </div>
            </div>

          </div>
        </div>

        <div class="d-flex justify-content-end">
          <button
            type="button"
            class="btn btn-outline-light btn-lg me-3 px-4"
            (click)="toggleEditMode()"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-light btn-lg px-4" [disabled]="!workshopForm.form.valid">Save</button>
        </div>
      </form>
    </div>
  </div>

</div>
